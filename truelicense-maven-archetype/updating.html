<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.4 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Language" content="en" />
    <title>TrueLicense Maven Archetype &#x2013; Updating Your Project</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      <!-- Google Analytics -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28191662-1']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
      </head>
    <body class="topBarEnabled">
      <div id="topbar" class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
            <div class="container"><div class="nav-collapse">
            <ul class="nav">
        <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="index.html" title="Overview">Overview</a></li>
            <li><a href="prerequisites.html" title="Prerequisites">Prerequisites</a></li>
            <li><a href="generating.html" title="Generating Your Project">Generating Your Project</a></li>
            <li><a href="examples.html" title="Example Configurations">Example Configurations</a></li>
            <li><a href="exploring.html" title="Exploring Your Project">Exploring Your Project</a></li>
            <li><a href="setting-up-vcs.html" title="Setting Up a VCS">Setting Up a VCS</a></li>
            <li><a href="building.html" title="Building Your Project">Building Your Project</a></li>
            <li><a href="using-cli.html" title="Using the CLI">Using the CLI</a></li>
            <li><a href="using-gui.html" title="Using the GUI">Using the GUI</a></li>
            <li><a href="using-wsi.html" title="Using the WSI">Using the WSI</a></li>
            <li><a href="using-api.html" title="Using the API">Using the API</a></li>
            <li><a href="certifying.html" title="Certifying Your Project">Certifying Your Project</a></li>
            <li><a href="updating.html" title="Updating Your Project">Updating Your Project</a></li>
        </ul>
      </li>
        <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reports <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li class="dropdown-submenu">
<a href="project-info.html" title="Project Information">Project Information</a>
              <ul class="dropdown-menu">
                  <li><a href="dependencies.html" title="Dependencies">Dependencies</a></li>
                  <li><a href="dependency-convergence.html" title="Dependency Convergence">Dependency Convergence</a></li>
                  <li><a href="dependency-info.html" title="Dependency Information">Dependency Information</a></li>
                  <li><a href="dependency-management.html" title="Dependency Management">Dependency Management</a></li>
                  <li><a href="distribution-management.html" title="Distribution Management">Distribution Management</a></li>
                  <li><a href="issue-tracking.html" title="Issue Management">Issue Management</a></li>
                  <li><a href="plugin-management.html" title="Plugin Management">Plugin Management</a></li>
                  <li><a href="license.html" title="Licenses">Licenses</a></li>
                  <li><a href="plugins.html" title="Plugins">Plugins</a></li>
                  <li><a href="project-summary.html" title="Summary">Summary</a></li>
                  <li><a href="team-list.html" title="Team">Team</a></li>
                  <li><a href="source-repository.html" title="Source Code Management">Source Code Management</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
<a href="project-reports.html" title="Project Reports">Project Reports</a>
              <ul class="dropdown-menu">
                  <li><a href="clirr-report.html" title="Clirr">Clirr</a></li>
                  <li><a href="jdepend-report.html" title="JDepend">JDepend</a></li>
              </ul>
            </li>
        </ul>
      </li>
              </ul>
<form id="search-form" action="https://www.google.com/search" method="get"  class="navbar-search pull-right" >
      <input value="truelicense.net/truelicense-maven-archetype/" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript">asyncJs( 'https://cse.google.com/brand?form=search-form' )</script>
                    <ul class="nav pull-right">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">External Links <b class="caret"></b></a>
                <ul class="dropdown-menu">
    <li><a href="http://illegalexception.schlichtherle.de" title="Christian's Blog">Christian's Blog</a></li>
                </ul>
              </li>
            </ul>
            </div>
        </div>
      </div>
    </div>
    <div class="container">
      <div id="banner">
        <div class="pull-left"><a href="../index.html" id="bannerLeft"><h2><h1 style="color: rgb(51,51,51); font-size: 50px; font-style: oblique; font-variant: small-caps; letter-spacing: 1pt; text-shadow: 5pt 5pt 5pt rgba(0,0,0,.33)">TrueLicen<span style="font-size: 70%">$&euro;</span></h1></h2>
</a></div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li class=""><a href="../index.html" title="Home">Home</a><span class="divider">/</span></li>
      <li class=""><a href="index.html" title="TrueLicense Maven Archetype">TrueLicense Maven Archetype</a><span class="divider">/</span></li>
    <li class="active ">Updating Your Project</li>
        </ul>
      </div>
        <div id="bodyColumn" >
<p></p>
<div class="section">
<h2><a name="Updating_Your_Project"></a>Updating Your Project</h2>
<p>This page shows you how to update your project <i>after</i> you have put it into production for selling license keys. <b>If you have not put the project into production yet then this page does not apply to you!</b> In particular, if you want to change any of the properties when <a href="generating.html">generating your project</a> then please repeat this process and generate another project.</p>
<div class="section">
<h3><a name="Overview"></a>Overview</h3>
<p>The <tt>pom.xml</tt> file in the project directory contains an XML element named <tt>properties</tt>:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;project [...]&gt;
    &lt;properties&gt;
        [...]
    &lt;/properties&gt;
&lt;/project&gt;
</pre></div></div>
<p>Its contents are a list of <abbr title="eXtensible Markup Language">XML</abbr> elements in the form <tt>&lt;name&gt;value&lt;/name&gt;</tt>. Each element defines a property name and value. These properties are used for code generation, e.g. there is a property named <tt>subject</tt> whose value defines the subject of the license management - see below. Their values have been computed from the property values you have provided to the TrueLicense Maven Archetype when generating your project.</p>
<div class="section">
<h4><a name="Warning"></a>Warning</h4>
<p><b>Changing the property values in the <tt>pom.xml</tt> file generally breaks the compatibility with existing license keys!</b> Don&#x2019;t do this except for the following use cases as explained below. If you have not already done so, then <b>please <a href="setting-up-vcs.html">set-up a VCS</a> for your project now!</b></p>
<hr /></div></div>
<div class="section">
<h3><a name="Limiting_License_Key_Validity"></a>Limiting License Key Validity</h3>
<p>Let&#x2019;s assume you want to limit the validity of the license keys for your software product to a particular version number range, e.g. the same major version number. Then you should include this version number range, e.g. the major version number 1, in the value of the property named <tt>subject</tt>:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;subject&gt;Product 1&lt;/subject&gt;
</pre></div></div>
<p>Later, when you want to transition to a new version number range, e.g. from major version number 1 to 2, then all you have to do in order to invalidate all previously generated license keys is to update the property value accordingly:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;subject&gt;Product 2&lt;/subject&gt;
</pre></div></div>
<p>It does not matter how you format the version number range in the licensing subject because the validation function simply checks the equality of the complete string. So if you like, you could also set the property value to <tt>Product 1.x</tt> or <tt>Product 2.x</tt> instead of <tt>Product 1</tt> or <tt>Product 2</tt>, respectively. If an invalid license key is found by TrueLicense, e.g. because a user hasn&#x2019;t bought another license key for your new release, then a <a href="../apidocs/net/truelicense/api/LicenseValidationException.html"><tt>net.truelicense.api.LicenseValidationException</tt></a> gets thrown.</p>
<hr /></div>
<div class="section">
<h3><a name="Adding_an_Edition"></a>Adding an Edition</h3>
<div class="section">
<h4><a name="Adding_the_Name"></a>Adding the Name</h4>
<p>Let&#x2019;s assume you want to add another edition to your software product so that you can sell another type of license keys for the new edition. The value of the property named <tt>editions</tt> defines a comma separated list of edition names, ordered from supersets to subsets. Each name must be a valid Java identifier and should be camel-cased with the initial character being lower-cased. The name &#x201c;ftp&#x201d; is reserved for an auto-generated free trial period. If you didn&#x2019;t define a value for this property when <a href="generating.html">generating your project</a>, then the default value is <tt>standard</tt>:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;editions&gt;standard&lt;/editions&gt;
</pre></div></div>
<p>You can simply add the name of the new edition to this list. Mind the sorting order from supersets to subsets.</p>
<p>For example, if you want to add an <i>Enterprise Edition</i> which shall be a <i>superset</i> of the existing <i>Standard Edition</i> (sold at a higher price), then you need to insert the name of the <tt>enterprise</tt> edition <i>before</i> the name of the <tt>standard</tt> edition:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;editions&gt;enterprise standard&lt;/editions&gt;
</pre></div></div>
<p>On the other hand, if you want add a <i>Lite Edition</i> which shall be a <i>subset</i> of the existing <i>Standard Edition</i> (sold at a lower price), then you need to append the name of the <tt>lite</tt> edition <i>after</i> the name of the <tt>standard</tt> edition:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;editions&gt;standard lite&lt;/editions&gt;
</pre></div></div></div>
<div class="section">
<h4><a name="Adding_Passwords"></a>Adding Passwords</h4>
<p>For each edition, TrueLicense needs passwords for (a) accessing the private key for signing license beans and (b) encrypting and decrypting license keys.</p>
<p>If you don&#x2019;t configure a password for (a), then it defaults to the password used for verying the integrity of the private key store, which in turn defaults to the default password defined when generating your project. You don&#x2019;t need to change this password at all, but if you want to, then you can do so by adding a property named <tt>${edition}KeyEntryPassword</tt>, where you need to replace <tt>${edition}</tt> with the name of the new edition. For example, you can add a password for an edition named <tt>enterprise</tt> like this:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;enterpriseKeyEntryPassword&gt;[...]&lt;/enterpriseKeyEntryPassword&gt;
</pre></div></div>
<p>If you don&#x2019;t configure a password for (b), then it defaults to the default password defined when generating your project. Again, you don&#x2019;t need to change this password, but if you want to, then you can do so by adding a property named <tt>${edition}PbePassword</tt>, where you need to replace <tt>${edition}</tt> with the name of the new edition. For example, you can add a password for an edition named <tt>enterprise</tt> like this:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;enterprisePbePassword&gt;[...]&lt;/enterprisePbePassword&gt;
</pre></div></div></div>
<div class="section">
<h4><a name="Updating_Key_Stores"></a>Updating Key Stores</h4>
<p>Next, the private and public key stores need to get updated so that they contain an entry for the new edition. This is done automatically when you are <a href="building.html">building your project</a> for the very first time. However, because the new edition is added as an afterthought, this needs to be done manually. The general pattern for this step is to run the following command:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ mvn generate-resources \
    -Pgenerate-private-key-store \
    -Pgenerate-public-key-store \
    -Deditions=${edition}
[...]
</pre></div></div>
<p>&#x2026; where you need to replace <tt>${edition}</tt> with the name of the new feature set. For example, you can update the key stores for an edition named <tt>enterprise</tt> like this:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ mvn generate-resources \
    -Pgenerate-private-key-store \
    -Pgenerate-public-key-store \
    -Deditions=enterprise
[...]
</pre></div></div></div>
<div class="section">
<h4><a name="Purchasing_a_TrueLicense_Certificate"></a>Purchasing a TrueLicense Certificate</h4>
<p>Mind that you need to buy another TrueLicense certificate for each feature set you want to add or otherwise you are required to open source your software product under the terms of the <a href="license.html#GNU_AFFERO_GENERAL_PUBLIC_LICENSE_Version_3_19_November_2007">GNU AFFERO GENERAL PUBLIC LICENSE, Version 3</a>. See <a href="certifying.html">certifying your project</a>.</p>
<hr /></div></div>
<div class="section">
<h3><a name="Migrating_Your_Project"></a>Migrating Your Project</h3>
<p>Let&#x2019;s assume you want to update your project and benefit from the latest improvements in TrueLicense. In this case, you need to generate a <i>new project</i> and customize it so that it&#x2019;s fully compatible with existing license keys, i.e. it must be possible to share the same license keys between the old and the new project.</p>
<div class="section">
<h4><a name="Generating_Your_project"></a>Generating Your project</h4>
<p>First, you need to generate the new project by following the instructions in the page <a href="generating.html">generating your project</a> and defining the value of the properties as explained in the following sections.</p>
<div class="section">
<h5><a name="Migrating_from_the_TrueLicense_Maven_Archetype_before_version_2.4"></a>Migrating from the TrueLicense Maven Archetype before version 2.4</h5>
<p>If the old project was generated using the TrueLicense Maven Archetype before version 2.4, then you need to define the values of the following properties as follows:</p>

<dl class="dl-horizontal dt-wide">
    
<dt><tt>password</tt></dt>
    
<dd>Enter the value produced by the obfuscated string field 
        <tt>PBE_PASSWORD</tt> in the class 
        <tt>**.keymgr.LicensingSchema$Lazy</tt>.</dd>
    
<dt><tt>freeTrialPeriod</tt></dt>
    
<dd>Enter the value of the field <tt>FTP_DAYS</tt> in the same class.</dd>
    
<dt><tt>ftpKeyStoreFile</tt></dt>
    
<dd>Enter <tt>ftp.ks</tt>.</dd>
    
<dt><tt>ftpSecretMarkerClass</tt></dt>
    
<dd>Enter the parameter value of the last call to the method 
        <tt>.storeInUserNode([...])</tt> in the same class, but without the 
        <tt>.class</tt> suffix, e.g. <tt>sun.security.provider.Sun</tt>.</dd>
    
<dt><tt>licenseKeyFormat</tt></dt>
    
<dd>Search for the expression matching the pattern 
        <tt>new *ManagementContext(SUBJECT)</tt> in the same class and 
        select the value as follows:
        
<ul>
            
<li>For <tt>new V1LicenseManagementContext(SUBJECT)</tt>, 
                enter <tt>V1</tt>.</li>
            
<li>For <tt>new V2XmlLicenseManagementContext(SUBJECT)</tt>, 
                enter <tt>V2/XML</tt>.</li>
            
<li>For <tt>new V2JsonLicenseManagementContext(SUBJECT)</tt>, 
                enter <tt>V2/JSON</tt> (default).</li>
        </ul></dd>
    
<dt><tt>subject</tt></dt>
    
<dd>Enter the value of the field <tt>SUBJECT</tt> in the same class.</dd>
    
<dt><tt>package</tt></dt>
    
<dd>Enter the part of the package name before the <tt>keymgr</tt>
        element in the same class.</dd>
    
<dt><tt>preferencesType</tt></dt>
    
<dd>Search for the expression matching the pattern 
        <tt>storeIn*Node(LicensingSchema.class)</tt> and select the value 
        as follows:
        
<ul>
            
<li>For <tt>storeInSystemNode(LicensingSchema.class)</tt>, 
                enter <tt>system</tt>.</li>
            
<li>For <tt>storeInUserNode(LicensingSchema.class)</tt>, 
                enter <tt>user</tt>.</li>
        </ul></dd>
</dl>
<p>All other properties may have different values.</p></div>
<div class="section">
<h5><a name="Migrating_from_the_TrueLicense_Maven_Archetype_since_version_2.4"></a>Migrating from the TrueLicense Maven Archetype since version 2.4</h5>
<p>If the old project was generated using the TrueLicense Maven Archetype version 2.4 or later, then you need to make sure that the values of the following properties are equal:</p>

<ul>
  
<li><tt>editions</tt></li>
  
<li><tt>freeTrialPeriod</tt></li>
  
<li><tt>ftpKeyStoreFile</tt></li>
  
<li><tt>ftpSecretMarkerClass</tt></li>
  
<li><tt>keyStoreType</tt></li>
  
<li><tt>licenseKeyFormat</tt></li>
  
<li><tt>password</tt></li>
  
<li><tt>pbeAlgorithm</tt></li>
  
<li><tt>preferencesType</tt></li>
  
<li><tt>privateKeyStoreFile</tt></li>
  
<li><tt>publicKeyStoreFile</tt></li>
  
<li><tt>subject</tt></li>
</ul>
<p>All other properties may have different values.</p></div></div>
<div class="section">
<h4><a name="Copying_Key_Stores"></a>Copying Key Stores</h4>
<p>Please copy the following files from the old project to the new project:</p>

<ul>
  
<li><tt>${artifactId}-keygen/src/main/resources/${privateKeyStoreFile}</tt></li>
  
<li><tt>${artifactId}-keymgr/src/main/resources/${ftpKeyStoreFile}</tt></li>
  
<li><tt>${artifactId}-keymgr/src/main/resources/${publicKeyStoreFile}</tt></li>
</ul>
<p>Of course, the path names need to remain the same.</p></div>
<div class="section">
<h4><a name="Customizing_Properties"></a>Customizing Properties</h4>
<p>The parent POM file <tt>pom.xml</tt> contains a set of properties with the following name patterns:</p>

<ul>
  
<li><tt>*Alias</tt></li>
  
<li><tt>*Password</tt></li>
  
<li><tt>*Type</tt></li>
</ul>
<p>&#x2026; where <tt>*</tt> matches any prefix. Please check the documentation comments for each of these properties and customize their values so that they match the configuration of the old project.</p>
<p><b>If the old project was generated using the TrueLicense Maven Archetype before version 2.4, then its generally necessary to change the value of the properties named <tt>*Alias</tt> to <tt>mykey</tt></b>, which is the default alias name for any private key or trusted certificate entry generated by the Java <tt>keytool</tt>.</p></div>
<div class="section">
<h4><a name="Building_Your_project"></a>Building Your project</h4>
<p>You are now set for <a href="building.html">building your project</a> again.</p>
<hr />

<ul class="pager">
  
<li class="previous">
    <a href="certifying.html">&#x2190; Certifying Your Project</a>
  </li>
</ul></div></div></div>
        </div>
    </div>
    <hr/>
    <footer>
      <div class="container">
        <div class="row">
            <p class="pull-left">Copyright &copy;2005&#x2013;2017
<a href="http://schlichtherle.de">Schlichtherle IT Services</a>.
All rights reserved.        <li id="publishDate" class="pull-right">Last Published: 2017-10-03</li>
          <li id="projectVersion" class="pull-right">Version: 3.0.0</li>
</p>
        </div>
        <p id="poweredBy" class="pull-right">  <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
  </p>
        </div>
    </footer>
    </body>
</html>
